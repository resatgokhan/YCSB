# Workload reference

This repository uses YCSB-C `CoreWorkload` specs in `workloads/*.spec` (or generated by `./workloads.sh`). Below is a quick guide to what each property means, how operations are executed, and what the provided workloads do.

## How operations behave
- Load phase inserts `recordcount` records with sequential keys (`user0`, `user1`, …) generated by `NextSequenceKey`. Inserts always append new keys; they do not reuse deleted keys.
- Transaction phase picks the operation using the configured proportions. Keys come from `NextTransactionKey`, which draws from the chosen distribution (zipfian, latest, uniform) over the range of keys that have been inserted so far. A deleted key can still be chosen later, so reads/updates after a delete may hit missing records (and will be reported as errors).
- `read`: fetches one field or all fields (here all fields) for the chosen key.
- `update` (a.k.a. put): rewrites one or all fields of the chosen key; does not change the key set.
- `insert`: adds a brand-new sequential key at the tail of the keyspace; only used in workloads with `insertproportion>0` (e.g., D/E).
- `delete`: removes the chosen key via the DB’s `Delete` API; underlying engines may implement this as a tombstone.
- `scan`: reads a contiguous range starting at the chosen key for `scanlength` items; only used in workload E. `maxscanlength` and `scanlengthdistribution` bound the length.
- `readmodifywrite`: read then update the same key as a single logical operation; only used in workload F.

## Spec properties used here
- `recordcount` / `operationcount`: number of records loaded and total operations issued during the run.
- `fieldcount` / `fieldlength` / `field_len_dist`: shape of each record. Provided specs use 1 field of constant 100 bytes; standard YCSB A–F use defaults (10 fields, 100 bytes each unless changed via CLI overrides).
- `readallfields` / `writeallfields`: if true, operations touch all fields; otherwise a single field is selected per request.
- `readproportion`, `updateproportion`, `deleteproportion`, `insertproportion`, `scanproportion`, `readmodifywriteproportion`: mix of operations; values sum to 1.0.
- `requestdistribution`: key popularity; zipfian favors hot keys, latest favors the most recently inserted keys, uniform is flat.
- Optional extras: `maxscanlength` and `scanlengthdistribution` (only for scans), `insertorder` (ordered or hashed), `zeropadding` for key formatting.

## Provided workloads
Custom mixes (also emitted by `./workloads.sh`):
- `workload_get`: 100% read.
- `workload_put`: 100% update.
- `workload_delete`: 100% delete.
- `workload_mixed_read_heavy`: 70% read, 20% update, 10% delete.
- `workload_mixed_balanced`: 40% read, 40% update, 20% delete.
- `workload_mixed_write_delete`: 10% read, 50% update, 40% delete.

Standard YCSB mixes:
- `workloada`: 50% read, 50% update (zipfian).
- `workloadb`: 95% read, 5% update (zipfian).
- `workloadc`: 100% read (zipfian).
- `workloadd`: 95% read, 5% insert (latest distribution biases to newest keys).
- `workloade`: 95% scan (range reads up to 100 keys), 5% insert (zipfian for starting key).
- `workloadf`: 50% read, 50% read-modify-write (zipfian).

## Interpreting results with deletes
- Because keys are chosen from the existing key range, deletes shrink the live set but do not remove keys from the chooser. Expect some reads/updates after deletes to fail with “not found”; these failures are counted in the reported status totals.
- Insert proportions grow the key range; delete-only workloads will steadily decrease the live set until every delete encounters a missing key (which will show up as errors).
- If you want to keep the live set size stable while mixing inserts and deletes, balance their proportions and monitor the reported success/error counts.
